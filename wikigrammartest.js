var text =
'{{notice|Previous data has been archived since the fractal reward update on December 15, 2015 and can be found [[Cracked Fractal Encryption/research/archive|here]].}}\n' +
'\n' +
'{{SDRH\n' +
' | title = Fractal mastery 4 | class = | labels = yes | size = 50\n' +
'  | Manuscript of \'Halfway There and...\' | s1  = Manuscript     | label1 = Manuscript\n' +
'  | Postulate of Construction            | s2  = Postulate      | label2 = Postulate\n' +
'  | Proof of Bask\'s Theorem              | s3  = Proof          | label3 = Proof\n' +
'  | Treatise on Convergence              | s4  = Treatise       | label4 = Treatise\n' +
'  | Recipe: Ascended Heavy Helm          | s5  = Armor Recipe   | label5 = Armor recipe (Non-Breather)\n' +
'  | Recipe: Angchu Cloth Breather        | s6  = Breather Recipe| label6 = Breather recipe\n' +
'  | Recipe: Ascended Focus               | s7  = Weapon Recipe  | label7 = Weapon Recipe\n' +
'  | Fractal Relic                        | s8  = Fractal Relic  | label8 = Fractal Relic\n' +
'  | Pile of Bloodstone Dust              | s9  = Bloodstone Dust| label9 = Bloodstone Dust\n' +
'  | Dragonite Ore                        | s10 = Dragonite Ore  | label10 = Dragonite Ore\n' +
'  | Empyreal Fragment                    | s11 = Empyreal Fragment| label11 = Empyreal Fragment\n' +
'  | Vial of Potent Blood                 | s12 = Potent Blood   | label12 = Vial of Potent Blood\n' +
'  | Large Bone                           | s13 = Large Bone     | label13 = Large Bone\n' +
'  | Large Claw                           | s14 = Large Claw     | label14 = Large Claw\n' +
'  | Large Scale                          | s15 = Large Scale    | label15 = Large Scale\n' +
'  | Large Fang                           | s16 = Large Fang     | label16 = Large Fang\n' +
'  | Intricate Totem                      | s17 = Intricate Totem| label17 = Intricate Totem\n' +
'  | Potent Venom Sac                     | s18 = Potent Venom   | label18 = Potent Venom Sac\n' +
'  | Pile of Incandescent Dust            | s19 = Incandescent Dust | label19 = Pile of <br> Incandescent Dust\n' +
'  | Aetherized Greatsword                | s20 = Aetherized Skin| label20 = Aetherized Skin\n' +
'  | Mini Professor Mew                   | s21 = Mini Mew       | label21 = Mini Professor Mew\n' +
'  | Fractal Encryption Key               | s22 = Key            | label22 = Fractal Encryption Key\n' +
'  | 1 Agony Infusion                     | s23 = Infusion | label23 = +1 Agony Infusion\n' +
'}}\n' +
'\n' +
'<!-- Please put your data here! Use the following as a template:\n' +
'\n' +
'{{SDRL| Total = 0 | Manuscript = 0 | Postulate = 0 | Proof = 0 | Treatise = 0 | Armor Recipe = 0 | Breather Recipe = 0 | Weapon Recipe = 0 | Fractal Relic = 0 | Bloodstone Dust = 0 | Dragonite Ore = 0 | Empyreal Fragment = 0 | Potent Blood = 0 | Large Bone = 0 | Large Claw = 0 | Large Scale = 0 | Large Fang = 0 | Intricate Totem = 0 | Potent Venom = 0 | Incandescent Dust = 0 | Aetherized Skin = 0 | Mini Mew = 0 | Key = 0 | Infusion = 0 | ~~~~}}\n' +
' -->\n' +
'\n' +
'{{SDRL| Total = 230 | Manuscript = 80 | Postulate = 52 | Proof = 90 | Treatise = 76 | Armor Recipe = 0 | Breather Recipe = 7 | Weapon Recipe = 2 | Fractal Relic = 90 | Bloodstone Dust = 250 | Dragonite Ore = 200 | Empyreal Fragment = 250 | Potent Blood = 95 | Large Bone = 60 | Large Claw = 95 | Large Scale = 95 | Large Fang = 75 | Intricate Totem = 65 | Potent Venom = 60 | Incandescent Dust = 65 | Aetherized Skin = 0 | Mini Mew = 2 | Key = 22 | Infusion = 519 | [[User:Diox8tony|Diox8tony]] ([[User talk:Diox8tony|talk]]) 18:38, 26 December 2015 (UTC)}}\n' +
'\n' +
'{{SDRL| Total = 319 | Manuscript = 102 | Postulate = 91 | Proof = 125 | Treatise = 94 | Armor Recipe = 0 | Breather Recipe = 10 | Weapon Recipe = 0 | Fractal Relic = 75 | Bloodstone Dust = 450 | Dragonite Ore = 405 | Empyreal Fragment = 270 | Potent Blood = 80 | Large Bone = 110 | Large Claw = 105 | Large Scale = 95 | Large Fang = 150 | Intricate Totem = 90 | Potent Venom = 90 | Incandescent Dust = 100 | Aetherized Skin = 0 | Mini Mew = 2 | Key = 37 | Infusion = 716 | [[User:Appletoasty|Appletoasty]] ([[User talk:Appletoasty|talk]]) 20:17, 15 December 2015 (UTC)}}\n' +
'\n' +
'{{SDRL| Total = 55 | Manuscript = 6 | Postulate = 20 | Proof = 26 | Treatise = 15 | Armor Recipe = 1 | Breather Recipe = 0 | Weapon Recipe = 0 | Fractal Relic = 10 | Bloodstone Dust = 30 | Dragonite Ore = 60 | Empyreal Fragment = 45 | Potent Blood = 15 | Large Bone = 25 | Large Claw = 30 | Large Scale = 15 | Large Fang = 25 | Intricate Totem = 15 | Potent Venom = 20 | Incandescent Dust = 5 | Aetherized Skin = 0 | Mini Mew = 0 | Key = 8 | Infusion = 112 | [[User:Darqam|Darqam]] ([[User talk:Darqam|talk]]) 02:08, 22 December 2015 (UTC)}}\n' +
'\n' +
'{{SDRL| Total = 30000 | Manuscript = 4233 | Postulate = 8566 | Proof = 12991 | Treatise = 8616 | Armor Recipe = 113 | Breather Recipe = 842 | Weapon Recipe = 119 | Fractal Relic = 9960 | Bloodstone Dust = 29850 | Dragonite Ore = 30755 | Empyreal Fragment = 29640 | Potent Blood = 10210 | Large Bone = 9830 | Large Claw = 10445 | Large Scale = 10685 | Large Fang = 10475 | Intricate Totem = 10320 | Potent Venom = 9745 | Incandescent Dust = 9950 | Aetherized Skin = 4 | Mini Mew = 133 | Key = 3001 | Infusion = 67948 | [[User:Towelcat|Towelcat]] ([[User talk:Towelcat|talk]]) 15:13, 28 December 2015 (UTC)}}\n' +
'\n' +
'{{SDRL| Total = 500 | Manuscript = 168 | Postulate = 145 | Proof = 215 | Treatise = 129 | Armor Recipe = 0 | Breather Recipe = 13 | Weapon Recipe = 6 | Fractal Relic = 150 | Bloodstone Dust = 765 | Dragonite Ore = 390 | Empyreal Fragment = 555 | Potent Blood = 220 | Large Bone = 150 | Large Claw = 230 | Large Scale = 150 | Large Fang = 150 | Intricate Totem = 165 | Potent Venom = 180 | Incandescent Dust = 165 | Aetherized Skin = 0 | Mini Mew = 3 | Key = 38 | Infusion = 115 | Anon 2/7/2015 (UTC)}}\n' +
'\n' +
'\n' +
'{{SDRL| Total = 100 | Manuscript = 48 | Postulate = 26 | Proof = 36 | Treatise = 27 | Armor Recipe = 0 | Breather Recipe = 2 | Weapon Recipe = 1 | Fractal Relic = 25 | Bloodstone Dust = 105 | Dragonite Ore = 15 | Empyreal Fragment = 105 | Potent Blood = 35 | Large Bone = 35 | Large Claw = 45 | Large Scale = 30 | Large Fang = 30 | Intricate Totem = 35 | Potent Venom = 70 | Incandescent Dust = 30 | Aetherized Skin = 0 | Mini Mew = 0 | Key = 9 | Infusion = 230 | [[User:Dorid|Dorid The Blue]] ([[User talk:Dorid|talk]]) 18:12, 19 February 2016 (UTC))}}\n' +
'\n' +
'<!-- end of data -->\n' +
'{{SDRF}}';

var wikigrammar = require('./src/js/wikigrammar.js'),
    prettyjson = require('prettyjson')
    ;


try {
    console.log(prettyjson.render(wikigrammar.parse(text, {
        /*trace: function() {
            console.log("tracer:", arguments);
        }*/
    })));
} catch(e) {
    if(e instanceof wikigrammar.SyntaxError) {
        console.log("Syntax error:", e.message);
        console.log("Location:", e.location.start.line + ":" + e.location.start.column + " => " + e.location.end.line + ":" + e.location.end.column);
        console.log("Expected:", e.expected);
        console.log("Found:", e.found);
    } else {
        throw e;
    }
}